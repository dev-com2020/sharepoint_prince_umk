<script>
  document.addEventListener("DOMContentLoaded", function () {
    const formTable = document.querySelector(".ms-formtable");
    if (!formTable) {
      console.error("Nie znaleziono tabeli formularza.");
      return;
    }
  
    const rows = Array.from(formTable.querySelectorAll("tr"));
    const sections = [
      { title: "SEKCJA 1", range: [0, 2] },
      { title: "SEKCJA 2", range: [3, 5] },
      { title: "SEKCJA 3", range: [6, rows.length - 1] },
    ];
  
    // Dodanie informacji o trybie edycji
    const modeInfo = document.createElement("div");
    modeInfo.className = "mode-info";
    const toolbar = document.querySelector(".ms-formtoolbar"); // Pasek narzędzi formularza
    if (toolbar && toolbar.textContent.includes("Zapisz")) {
      modeInfo.textContent = "Formularz jest w trybie edycji.";
    } else {
      modeInfo.textContent = "Formularz jest w trybie odczytu.";
    }
    document.body.insertBefore(modeInfo, document.body.firstChild);
  
    // Podział formularza na sekcje
    sections.forEach(section => {
      const sectionDiv = document.createElement("div");
      sectionDiv.className = "form-section";
  
      const sectionHeader = document.createElement("div");
      sectionHeader.textContent = section.title;
      sectionHeader.className = "section-header";
      sectionHeader.style.cursor = "pointer";
  
      const sectionContent = document.createElement("div");
      sectionContent.className = "section-content";
      rows.slice(section.range[0], section.range[1] + 1).forEach(row => {
        sectionContent.appendChild(row);
      });
      sectionContent.style.display = "none";
  
      sectionHeader.addEventListener("click", () => {
        sectionContent.style.display = sectionContent.style.display === "none" ? "block" : "none";
      });
  
      sectionDiv.appendChild(sectionHeader);
      sectionDiv.appendChild(sectionContent);
      formTable.parentNode.insertBefore(sectionDiv, formTable);
    });
  
    formTable.style.display = "none";
  });
  </script>
  
  <style>
  /* Informacja o trybie edycji */
  .mode-info {
    background-color: #c91a1d;
    color: #000;
    padding: 10px;
    text-align: center;
    font-weight: bold;
    font-size: 16px;
    border-bottom: 2px solid #e6b800;
    margin-bottom: 20px;
  }
  
  /* Stylizacja sekcji */
  .form-section {
    margin-bottom: 20px;
    border: 1px solid #ccc;
    border-radius: 5px;
    padding: 10px;
  }
  
  .section-header {
    background-color: #0078d7;
    color: white;
    padding: 10px;
    font-size: 16px;
    border-radius: 5px 5px 0 0;
    cursor: pointer;
  }
  
  .section-header:hover {
    background-color: #005a9e;
  }
  
  .section-content {
    display: none;
    padding: 10px;
    background-color: #f9f9f9;
    border: 1px solid #ccc;
    border-top: none;
  }
  </style>
  